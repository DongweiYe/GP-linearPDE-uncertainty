/local/295099/include/mcmc_posterior.py:123: UserWarning: There are not enough devices to run parallel chains: expected 2 but got 1. Chains will be drawn sequentially. If you are running MCMC in CPU, consider using `numpyro.set_host_device_count(2)` at the beginning of your program. You can double-check how many devices are available in your system using `jax.local_device_count()`.
  mcmc = MCMC(kernel, num_warmup=num_warmup, num_samples=num_samples,num_chains=2, chain_method='parallel', progress_bar=False)
Traceback (most recent call last):
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_differentiable_functions.py", line 141, in fun_wrapped
    fx = np.asarray(fx).item()
ValueError: can only convert an array of size 1 to a Python scalar

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/local/295099/main.py", line 129, in <module>
    result = minimize(neg_log_posterior, initial_guess, args=(Xu_fixed, Xf, Y, Xu_noise, prior_var*jnp.eye(2), param_iter),
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_minimize.py", line 699, in minimize
    res = _minimize_lbfgsb(fun, x0, args, jac, bounds,
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_lbfgsb_py.py", line 308, in _minimize_lbfgsb
    sf = _prepare_scalar_function(fun, x0, jac=jac, args=args, epsilon=eps,
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_optimize.py", line 263, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_differentiable_functions.py", line 158, in __init__
    self._update_fun()
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_differentiable_functions.py", line 251, in _update_fun
    self._update_fun_impl()
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_differentiable_functions.py", line 155, in update_fun
    self.f = fun_wrapped(self.x)
  File "/home/yanw/.conda/envs/uncertain/lib/python3.9/site-packages/scipy/optimize/_differentiable_functions.py", line 143, in fun_wrapped
    raise ValueError(
ValueError: The user-provided objective function must return a scalar value.
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[60994,1],0]
  Exit code:    1
--------------------------------------------------------------------------
cp: missing destination file operand after '*.png/home/yanw/uncertain/results/figures/0622'
Try 'cp --help' for more information.
cp: missing destination file operand after '/home/yanw/uncertain'
Try 'cp --help' for more information.
