

==> WARNING: A newer version of conda exists. <==
  current version: 4.12.0
  latest version: 23.7.3

Please update conda by running

    $ conda update -n base -c defaults conda




==> WARNING: A newer version of conda exists. <==
  current version: 4.12.0
  latest version: 23.7.3

Please update conda by running

    $ conda update -n base -c defaults conda


2023-08-30 17:08:55.576793: E external/xla/xla/stream_executor/gpu/asm_compiler.cc:114] *** WARNING *** You are using ptxas 11.0.221, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

2023-08-30 17:08:55.597185: W external/xla/xla/stream_executor/gpu/asm_compiler.cc:231] Falling back to the CUDA driver for PTX compilation; ptxas does not support CC 8.6
2023-08-30 17:08:55.597252: W external/xla/xla/stream_executor/gpu/asm_compiler.cc:234] Used ptxas at ptxas
2023-08-30 17:08:55.619770: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:548] failed to load PTX text as a module: CUDA_ERROR_INVALID_IMAGE: device kernel image is invalid
2023-08-30 17:08:55.619800: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:553] error log buffer (63 bytes): error   : Binary format for key='0', ident='' is not recognize
2023-08-30 17:08:55.619843: W external/xla/xla/service/gpu/runtime/support.cc:58] Intercepted XLA runtime error:
INTERNAL: Failed to load PTX text as a module: CUDA_ERROR_INVALID_IMAGE: device kernel image is invalid
2023-08-30 17:08:55.619884: E external/xla/xla/pjrt/pjrt_stream_executor_client.cc:2593] Execution of replica 0 failed: INTERNAL: Failed to execute XLA Runtime executable: run time error: custom call 'xla.gpu.func.launch' failed: Failed to load PTX text as a module: CUDA_ERROR_INVALID_IMAGE: device kernel image is invalid; current tracing scope: fusion; current profiling annotation: XlaModule:#hlo_module=jit__threefry_seed,program_id=0#.
Traceback (most recent call last):
  File "/local/232498/main.py", line 6, in <module>
    from include.init import ModelInitializer_2d
  File "/local/232498/include/init.py", line 4, in <module>
    from include.config import key_he, key_x_u, key_x_f, key_t_u, key_t_f
  File "/local/232498/include/config.py", line 3, in <module>
    key = jax.random.PRNGKey(42)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/random.py", line 177, in PRNGKey
    return _return_prng_keys(True, _key('PRNGKey', seed, impl))
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/random.py", line 139, in _key
    return prng.seed_with_impl(impl, seed)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 406, in seed_with_impl
    return random_seed(seed, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 689, in random_seed
    return random_seed_p.bind(seeds_arr, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 701, in random_seed_impl
    base_arr = random_seed_impl_base(seeds, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 706, in random_seed_impl_base
    return seed(seeds)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 935, in threefry_seed
    return _threefry_seed(seed)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/pjit.py", line 253, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/pjit.py", line 166, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 2596, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 389, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 821, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/pjit.py", line 1209, in _pjit_call_impl
    return xc._xla.pjit(name, f, call_impl_cache_miss, [], [], donated_argnums,
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/pjit.py", line 1192, in call_impl_cache_miss
    out_flat, compiled = _pjit_call_impl_python(
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/pjit.py", line 1148, in _pjit_call_impl_python
    return compiled.unsafe_call(*args), compiled
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1229, in __call__
    results = self.xla_executable.execute_sharded(input_bufs)
jax._src.traceback_util.UnfilteredStackTrace: jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Failed to execute XLA Runtime executable: run time error: custom call 'xla.gpu.func.launch' failed: Failed to load PTX text as a module: CUDA_ERROR_INVALID_IMAGE: device kernel image is invalid; current tracing scope: fusion; current profiling annotation: XlaModule:#hlo_module=jit__threefry_seed,program_id=0#.

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/local/232498/main.py", line 6, in <module>
    from include.init import ModelInitializer_2d
  File "/local/232498/include/init.py", line 4, in <module>
    from include.config import key_he, key_x_u, key_x_f, key_t_u, key_t_f
  File "/local/232498/include/config.py", line 3, in <module>
    key = jax.random.PRNGKey(42)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/random.py", line 177, in PRNGKey
    return _return_prng_keys(True, _key('PRNGKey', seed, impl))
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/random.py", line 139, in _key
    return prng.seed_with_impl(impl, seed)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 406, in seed_with_impl
    return random_seed(seed, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 689, in random_seed
    return random_seed_p.bind(seeds_arr, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 386, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 389, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/core.py", line 821, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 701, in random_seed_impl
    base_arr = random_seed_impl_base(seeds, impl=impl)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 706, in random_seed_impl_base
    return seed(seeds)
  File "/home/yanw/.conda/envs/noise/lib/python3.10/site-packages/jax/_src/prng.py", line 935, in threefry_seed
    return _threefry_seed(seed)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Failed to execute XLA Runtime executable: run time error: custom call 'xla.gpu.func.launch' failed: Failed to load PTX text as a module: CUDA_ERROR_INVALID_IMAGE: device kernel image is invalid; current tracing scope: fusion; current profiling annotation: XlaModule:#hlo_module=jit__threefry_seed,program_id=0#.
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[481,1],0]
  Exit code:    1
--------------------------------------------------------------------------
cp: cannot stat '*.pdf': No such file or directory
cp: missing destination file operand after '*.png/home/yanw/uncertain/results/figures/0830'
Try 'cp --help' for more information.
cp: missing destination file operand after '/home/yanw/uncertain'
Try 'cp --help' for more information.
